<!DOCTYPE html>
<html lang="en">
  <head>
    <title>User_Dashboard</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/static/style.css" />
    <style>
      body {
        background-color: #f8f9fa;
      }

      .card-summary {
        width: 280px;
        margin: 15px auto;
        border-radius: 16px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        color: white;
      }

      .card-summary h5 {
        font-weight: 500;
        margin-bottom: 5px;
      }

      .card-summary h3 {
        font-weight: 600;
      }

      .bg-info {
        background-color: #17a2b8 !important;
      }

      .bg-danger {
        background-color: #dc3545 !important;
      }

      .bg-success {
        background-color: #28a745 !important;
      }

      .bg-primary {
        background-color: #007bff !important;
      }

      .headings {
        margin-top: 30px;
      }

      #boxes {
        margin-top: 50px;
        margin-bottom: 40px;
      }

      #canvas {
        padding: 20px;
      }

      table {
        background-color: white;
      }

      .table thead {
        background-color: #e9ecef;
      }

      .table tbody tr:hover {
        background-color: #f1f1f1;
      }
    </style>
  </head>
  <body>
    <div id="main">
      <div id="canvas" class="overflow-auto">
        <nav class="navbar navbar-expand-lg bg-body-tertiary">
          <div class="container-fluid">
            <a class="navbar-brand" href="#">Welcome {{this_user.username}}</a>
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarSupportedContent"
              aria-controls="navbarSupportedContent"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                  <a class="nav-link active" href="/login">Log out</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link active" href="/summary">Summary</a>
                </li>
              </ul>
              <form class="d-flex" action="/results">
                <input
                  class="form-control me-2"
                  type="search"
                  name="search"
                  placeholder="Search"
                  aria-label="Search"
                />
                <select
                  class="form-select me-2"
                  aria-label="Default select example"
                  name="key"
                >
                  <option selected>select</option>
                  <option value="user">User</option>
                  <option value="card">Card</option>
                </select>
                <input
                  class="btn btn-outline-success"
                  type="submit"
                  value="Search"
                />
              </form>
            </div>
          </div>
        </nav>

        <div id="content">
          <h3 class="headings">Requested Cards</h3>
          <div class="border mb-4" style="max-height: 200px; overflow-y: scroll;">
            <table class="table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Type of card</th>
                  <th>User</th>
                  <th>Current status</th>
                  <th class="text-center">Action</th>
                </tr>
              </thead>
              <tbody>
                {% for info in all_info %}
                  {% if info.attribute_name == "Status" and info.attribute_value == "requested" %}
                    <tr>
                      <th>{{loop.index}}</th>
                      <td>{{info.card_name}}</td>
                      <td>{{info.creator.username}}</td>
                      <td>Requested</td>
                      <td class="d-flex justify-content-center">
                        <a
                          href="/update_status/{{info.card_name}}/{{info.user_id}}"
                          class="btn btn-primary mx-5"
                        >Review</a>
                      </td>
                    </tr>
                  {% endif %}
                {% endfor %}
              </tbody>
            </table>
          </div>

          <h3 class="headings">Cards Under Verification</h3>
          <div class="border mb-4" style="max-height: 150px; overflow-y: scroll;">
            <table class="table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Type of card</th>
                  <th>User</th>
                  <th>Current status</th>
                  <th class="text-center">Action</th>
                </tr>
              </thead>
              <tbody>
                {% for info in all_info %}
                  {% if info.attribute_name == "Status" and info.attribute_value == "under_verification" %}
                    <tr>
                      <th>{{loop.index}}</th>
                      <td>{{info.card_name}}</td>
                      <td>{{info.creator.username}}</td>
                      <td>Under Verification</td>
                      <td class="d-flex justify-content-center">
                        <a
                          href="/update_status/{{info.card_name}}/{{info.user_id}}"
                          class="btn btn-primary mx-5"
                        >Verify</a>
                      </td>
                    </tr>
                  {% endif %}
                {% endfor %}
              </tbody>
            </table>
          </div>

          <h3 class="headings">Verified Cards</h3>
          <div class="border mb-4" style="max-height: 150px; overflow-y: scroll;">
            <table class="table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Type of card</th>
                  <th>User</th>
                  <th>Current status</th>
                  <th class="text-center">Action</th>
                </tr>
              </thead>
              <tbody>
                {% for info in all_info %}
                  {% if info.attribute_name == "Status" and info.attribute_value == "verified" %}
                    <tr>
                      <th>{{loop.index}}</th>
                      <td>{{info.card_name}}</td>
                      <td>{{info.creator.username}}</td>
                      <td>Verified</td>
                      <td class="d-flex justify-content-center">
                        <a
                          href="/generate/{{info.card_name}}/{{info.user_id}}"
                          class="btn btn-primary mx-5"
                        >Generate</a>
                      </td>
                    </tr>
                  {% endif %}
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>

        <!-- Summary Cards (Stacked Vertically) -->
        <div id="boxes">
          <div class="card-summary bg-info text-center p-3">
            <h5>Users</h5>
            <h3>{{users}}</h3>
          </div>
          <div class="card-summary bg-danger text-center p-3">
            <h5>Requests</h5>
            <h3>{{requests}}</h3>
          </div>
          <div class="card-summary bg-success text-center p-3">
            <h5>Generated</h5>
            <h3>{{generated}}</h3>
          </div>
          <div class="card-summary bg-primary text-center p-3">
            <h5>Available Cards</h5>
            <h3>4</h3>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
